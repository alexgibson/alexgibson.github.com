<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Trouble with web browser orientation – Alex Gibson</title><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="A look at the current methods available to determine browser orientation, and details some of the problems found along the way."><meta name="author" content="Alex Gibson"><meta name="generator" content="Jekyll"><link rel="canonical" href="https://alxgbsn.co.uk/2012/08/27/trouble-with-web-browser-orientation/"><link rel="stylesheet" type="text/css" href="/assets/styles-951cacb99119fdd1539ea33c63267cefd204701971f5fa121659e9061852d996.css"><link rel="alternate" type="application/rss+xml" title="Alex Gibson" href="/feed/"><link rel="manifest" href="/manifest.json"><!--[if lt IE 9]>
    <script type="text/javascript" src="/assets/lib/html5shiv-6e9566e51098627c2824e546909ee18725d233fc9cdd81910819e7e108cf36c0.js"></script>
  <![endif]--><meta name="apple-mobile-web-app-title" content="Alex Gibson"><meta name="theme-color" content="#ecebe6"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/avatar-180-b1f192dbbe4ceec9c13c327fb0908af5ddbf621002116885f0cc2e8d8b6787c8.jpg"><link rel="icon" type="image/png" sizes="196x196" href="/assets/avatar-196-a65772ff09fa529d865e4f60735ded2bfb50711bafb1bd79cb2111d7c4ec461c.jpg"><link href="/assets/favicon-28523dd6d2b5917829586fe5248f9a408486e09f98117add94210f56aa7ead33.ico" rel="shortcut icon"></head><body><main role="main"><div class="masthead"><nav role="navigation"><ul><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/contact/">Contact</a></li></ul></nav><div class="theme-selector hidden"><form class="theme-form" method="get"><input type="radio" id="t-light" name="theme" value="t-light"> <label for="t-light" title="Light theme">Light</label> <input type="radio" id="t-dark" name="theme" value="t-dark"> <label for="t-dark" title="Dark theme">Dark</label></form></div></div><article><header role="banner"><h1>Trouble with web browser orientation</h1></header><section class="post"><p class="meta"><time datetime="2012-08-27">August 27 2012</time> 5 min read.</p><p>In a sensible world, determining web browser orientation on mobile and tablet devices should be as straight forward as querying a property such as <code class="highlighter-rouge">window.orientation</code> and hoping for a value such as <code class="highlighter-rouge">portrait</code> or <code class="highlighter-rouge">landscape</code> to get returned. Unfortunately, the harsh reality of current API’s and web browser inconsistencies makes the process way more complicated than it should be.</p><p>This post takes a look at the current methods available to web developers to determine browser orientation, and details some of the problems found along the way.</p><h2 id="windoworientation">window.orientation</h2><p><code class="highlighter-rouge">window.orientation</code> is supported on iOS and by the majority of Android devices on the market today. When queried, the property will return a number based on the degrees of rotation from a device’s <em>default orientation</em>.</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onOrientationChange</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">orientation</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">//default orientation</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">90</span><span class="p">:</span>
        <span class="c1">//90 degrees clockwise from default</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="o">-</span><span class="mi">90</span><span class="p">:</span>
        <span class="c1">//90 degrees anti-clockwise from default</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">180</span><span class="p">:</span>
        <span class="c1">//180 degrees from default</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure><p>Unfortunately, there are a lot of common misconceptions about what these values represent. For example, a value of <code class="highlighter-rouge">0</code> degrees does not necessarily mean <code class="highlighter-rouge">portrait</code>, as it depends on which orientation is considered to be <em>default</em> by the manufacturer. Some tablet browsers, such as the iPad, will use <code class="highlighter-rouge">0</code> for portrait. Some Android tablets, such as the Xoom, use <code class="highlighter-rouge">0</code> for landscape.</p><p>I have seen certain mobile web frameworks fall at this first hurdle, by assuming all browsers and devices share the same implementation as iOS Safari. It is the framework assumptions here that are at fault, not the browser implementation.</p><p>So just how do we check if a device is being held in portrait or landscape? We could just check <code class="highlighter-rouge">window.innerWidth</code> and <code class="highlighter-rouge">window.innerHeight</code> when the <code class="highlighter-rouge">orientationchange</code> event fires, right?</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onOrientationChange</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">orientation</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">&gt;=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="p">?</span> <span class="s1">'portrait'</span> <span class="p">:</span> <span class="s1">'landscape'</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure><p>Well, sadly no…</p><h2 id="here-come-the-android-quirks">Here come the Android quirks</h2><p>Unfortunately, some Android browsers seem to fire <code class="highlighter-rouge">orientationchange</code> before the window <code class="highlighter-rouge">resize</code> event, so checks for <code class="highlighter-rouge">window.innerWidth</code> and <code class="highlighter-rouge">window.innerHeight</code> can be reported incorrectly on some devices. A <code class="highlighter-rouge">setTimeout</code> can help, but it is not really reliable as the time it takes for these values to change seems to vary from device to device.</p><h2 id="windowonresize">window.onresize</h2><p>The next alternative is to use the window <code class="highlighter-rouge">resize</code> event instead. This will surely work reliably, right? Well yes, kind of. But with another inevitable Android catch:</p><p>Android 4.x stock browser fires <code class="highlighter-rouge">resize</code> whenever the on-screen keyboard is shown. Depending on the height of the keyboard and size of screen, this can result in <code class="highlighter-rouge">window.innerWidth</code> being greater than <code class="highlighter-rouge">window.innerHeight</code>, causing in an incorrect orientation to be reported. In order to combat this <code class="highlighter-rouge">resize</code> event triggering an unwanted change in orientation, it is necessary to store the previous orientation and check that <code class="highlighter-rouge">window.innerWidth</code> has actually changed. If only <code class="highlighter-rouge">window.innerHeight</code> changes, then the keyboard is likely visible.</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onResize</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">previousWidth</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">orientation</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">&gt;=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="p">?</span> <span class="s1">'portrait'</span> <span class="p">:</span> <span class="s1">'landscape'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure><h2 id="css-media-queries-and-windowmatchmedia">CSS Media Queries and window.matchMedia</h2><p>As a side note, this <code class="highlighter-rouge">resize</code> event behavior on Android 4.x stock browser will also trigger CSS orientation media queries, such as:</p><figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="k">@media</span> <span class="n">screen</span> <span class="n">and</span> <span class="p">(</span><span class="n">orientation</span><span class="p">:</span><span class="nb">portrait</span><span class="p">)</span> <span class="p">{</span>

<span class="p">}</span>

<span class="k">@media</span> <span class="n">screen</span> <span class="n">and</span> <span class="p">(</span><span class="n">orientation</span><span class="p">:</span><span class="nb">landscape</span><span class="p">)</span> <span class="p">{</span>

<span class="p">}</span></code></pre></figure><p>This can lead to unintentional styles being applied when the keyboard is visible, unless developers specify <code class="highlighter-rouge">min-width</code> or another attribute that must also satisfy the media query. Any JavaScript checks using <code class="highlighter-rouge">window.matchMedia</code> will also be affected in the same manner.</p><h2 id="other-clever-hacks">Other clever hacks</h2><p>There are some other solutions out there for determining browser orientation, including this <a href="http://fettblog.eu/blog/2012/04/16/robust-but-hacky-way-of-portraitlandscape-detection/">clever hack</a> that uses CSS Media Queries, but does not rely on <code class="highlighter-rouge">window.matchMedia</code> being supported.</p><h2 id="conclusion">Conclusion</h2><p>Given that <code class="highlighter-rouge">window.orientation</code> is not really all that useful, and <code class="highlighter-rouge">resize</code> event behavior can differ significantly between browsers, we still lack a robust API to report device orientation accurately. For such a basic feature that is commonly needed today, it is pretty ridiculous that a task like this proves to be so overly complicated.</p></section></article><footer role="contentinfo"><form role="search" class="search" action="https://duckduckgo.com/" method="get" title="Search this site"><label for="q">Search</label> <input type="hidden" name="sites" value="alxgbsn.co.uk"> <input class="search" type="search" name="q" id="q" placeholder="Search this site"> <button type="submit">Go</button></form><ul><li><a href="/feed/index.xml" title="RSS feed">Subscribe (RSS)</a></li></ul></footer></main><script type="module" src="/assets/main-058dcf1c5b2815b57e44c7ed387fe85f37926b180e1c41b60110ce86ad4e290d.js"></script></body></html>